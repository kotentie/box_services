<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/main.css">


        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
    <div class="container">
        <h1>Boxc Services</h1>
    <div class="row">
        <div class="service_menu col-md-5" id="services-area">
        </div>

            <div class="totals_table col-md-3">
                <div class="table_heading"> 
                    <h3 class="totals-title">Totals</h3> 
                </div>
                <table class="table table-striped" id="totals-table">
                        <!-- <tr>
                            <input type="text" id="total" value="" />
                        </tr> -->
                </table>
            </div>
        </div>
    </div>   
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
<script>

var boxcApi = {"C000":{"Service_Code":"C000","Service_Type":"PACK","Service":"PICK & PACK","Rate":"0.42 ","Unit":"PER ITEM","Cycle":"PER ITEM","Optional":"no"},"C001":{"Service_Code":"C001","Service_Type":"PACK","Service":"BOXC PACKAGING","Unit":"PER ITEM","Cycle":"PER ITEM","Optional":"no","options":[{"option":"C001-P01","name":"BOXC PACKAGING","rate":"0.00"},{"option":"C001-P02","name":"YOUR PACKAGING","rate":"0.02"},{"option":"C001-P03","name":"SUPER DUPER PACKAGING","rate":"0.10 "}]},"C002":{"Service_Code":"C002","Service_Type":"SHIP","Service":"IMPORT","Rate":"1.99","Unit":"PER ITEM","Cycle":"PER ITEM","Optional":"no"},"C003":{"Service_Code":"C003","Service_Type":"SHIP","Service":"US DELIVERY","Rate":"3.99 ","Unit":"PER ITEM","Cycle":"PER ITEM","Optional":"no"},"C004":{"Service_Code":"C004","Service_Type":"SHIP","Service":"INSURANCE","Rate":"0.00","Unit":"PER ITEM","Cycle":"PER ITEM","Optional":"yes"},"C005":{"Service_Code":"C005","Service_Type":"WAREHOUSE","Service":"STORAGE","Rate":"0.13","Unit":"PER SKU","Cycle":"MONTHLY","Optional":"no"},"C006":{"Service_Code":"C006","Service_Type":"WAREHOUSE","Service":"PRODUCT PHOTOS","Rate":"5.00","Unit":"PER SKU","Cycle":"ONCE","Optional":"yes"}}

var cycleSumObj = {};
var cycleArr = [];

// function createArrCycle() {
//     $.each (boxcApi, function(i, item){
//         var theCycle =  boxcApi[i].Cycle.replace(/\s+/g, '');
//         var theRate = parseFloat(boxcApi[i].Rate) 
//         if (!isNaN(theRate)){
//             if (cycleSumObj[theCycle] instanceof Array){
//             cycleSumObj[theCycle].push(theRate);
//             }else{
//             alert(theRate);
//             cycleSumObj[theCycle] = [];
//             cycleSumObj[theCycle].push(theRate);
//             }
//         }
//     });
//     alert(cycleSumObj.toSource());
// }


function fillCycleArr(){
    $.each(boxcApi, function(i, item){
        cycleArr.push(boxcApi[i].Cycle);
    });
    cycleArr = $.unique(cycleArr);
    $.each(cycleArr, function(i, item){
        $('#totals-table').append('<tr><td><div class="service_name"><h5>' + cycleArr[i] +'</h5> </div></td><td><div class="price"><h5 id=' + cycleArr[i].replace(/\s+/g, '') +'-price></h5></div></td></tr>');
        cycleSumObj[item] = 0;

    });
};


function sumCycleSumObj() {

  $( "input:checked").each(function () {
           var cycle = $(this).attr("data-cycle");
           var rate = parseFloat($(this).attr("data-rate"));
            cycleSumObj[cycle] += rate;

        });
  
    $.each(cycleArr, function(i, item){
        var cycleCleaned = item.replace(/\s+/g, '')
        $('#' + cycleCleaned + '-price' ).text('' + cycleSumObj[item] + '');
        cycleSumObj[item] = 0;
        });


};






// function sumPriceEstimate() {
//     var total = 0;
    
//     $( "input:checked").each(function () {
//            var m = $(this).attr("name");
//             total += parseFloat($(this).attr("data"));

//         });
//     alert(total);
//     $('#total').val(total.toFixed(1));

// };

function addHtml(){

$.each(boxcApi, function(i, item){
    var servicetypeClass = boxcApi[i].Service_Type.toLowerCase(),
                           optional;
    var servicetypeId = document.getElementById('' + servicetypeClass + '')
    if(servicetypeId === null){
        $('#services-area').append('<div class="table_heading" id="' + servicetypeClass + '"><h3>' + servicetypeClass + '</h3></div><table id="' + servicetypeClass + '-table" class="table table-striped"><tbody></tbody></table>')
    }else{

    } 
    
    if (boxcApi[i]['options']){
        nObjects = boxcApi[i].options.length
        $('#' + servicetypeClass + '-table tbody').append('<tr class ="'+ servicetypeClass +'"><td><img src="img/tick.gif" height="16" width="16"></td><td><div class="service_name"><h5>' + boxcApi[i].Service + '</h5></div></td><td></td></tr>');
        for (var a =0; a < nObjects; a++){
            $('.' + servicetypeClass).after('<tr class ="multi-options"><td><div class="radio"><input type="radio" name="' + boxcApi[i].options[a].ServiceCode + '"  data-rate="' + boxcApi[i].options[a].rate + '" data-cycle="' + boxcApi[i].Cycle + '"></div></td><td><div class="sub-subservice-name"><h6>' + boxcApi[i].options[a].name  + '</h6></div></td><td><div class="price ' + boxcApi[i].Cycle + '"><h5>' + boxcApi[i].options[a].rate + boxcApi[i].Unit + '</h5></div></td></tr>')
            
        }

          
    }

    else{

    if (boxcApi[i].Optional === "yes"){
        optional = '<div class="checkbox"><input type="checkbox" class="checkedbox" name="' + boxcApi[i].Service_Code + '" data-rate ="' + boxcApi[i].Rate + '" data-cycle ="' + boxcApi[i].Cycle + '"></div>';
    } 

    else {
        optional = '<input type="checkbox" name="' + boxcApi[i].Service_Code + '" class="checkedbox" style="display:none" value="checked" checked="checked" data-rate="' + boxcApi[i].Rate + '"data-cycle ="' + boxcApi[i].Cycle + '"><img src="img/tick.gif" alt="checkbox ticked" height="16" width="16">';
    }



     $('#' + servicetypeClass + '-table tbody').append('<tr><td>' + optional + '</td><td><div class="service_name"><h5>' + boxcApi[i].Service + '</h5></div></td><td><h5>' + boxcApi[i].Rate + boxcApi[i].Unit + '</h5></div></td></tr>' ); 

    }  
});

};

addHtml();
fillCycleArr();
sumCycleSumObj();

$('input[type=radio]').change(function() {
      // $('.radio').each(function () {
      //       if($(this).is(':checked')) {

      //       }
        // });
    sumCycleSumObj();
    
})



$('input[type=checkbox]').change(function () {
    
    sumCycleSumObj();
});

  
  </script>

    </body>
</html>
